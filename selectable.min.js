/*!
 *
 * Selectable
 * Copyright (c) 2017 Karl Saunders (http://mobius.ovh)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.17.4
 *
 */
(function(a,b){var c="Selectable";if(typeof exports==="object"){module.exports=b(c)}else if(typeof define==="function"&&define.amd){define([],b)}else{a[c]=b(c)}})(typeof global!=='undefined'?global:this.window||this.global,function(){"use strict";var m='classList'in document.documentElement;var q={add:function(a,c){m?a.classList.add(c):q.contains(a,c)||(a.className=a.className.trim()+" "+c)},remove:function(a,c){m?a.classList.remove(c):q.contains(a,c)&&(a.className=a.className.replace(new RegExp("(^|\\s)"+c.split(" ").join("|")+"(\\s|$)","gi")," "))},contains:function(a,c){if(a)return m?a.classList.contains(c):!!a.className&&!!a.className.match(new RegExp("(\\s|^)"+c+"(\\s|$)"))}};var u=function(e){return!!e.ctrlKey||!!e.metaKey};var z=function(e){return!!e.shiftKey};var A=["x","y"];var B={x:"x1",y:"y1"};var C={x:"x2",y:"y2"};var D=function(a){this.version="0.17.4";this.v=this.version.split(".").map(s=>parseInt(s,10));this.touch="ontouchstart"in window||(window.DocumentTouch&&document instanceof DocumentTouch);this.init(a)}D.prototype={init:function(a){var b=this;var c={filter:".ui-selectable",tolerance:"touch",appendTo:document.body,toggle:false,autoRefresh:true,throttle:50,lassoSelect:"normal",autoScroll:{threshold:0,increment:10,},saveState:false,ignore:false,maxSelectable:false,lasso:{border:'1px dotted #000',backgroundColor:'rgba(52, 152, 219, 0.2)',},keys:['shiftKey','ctrlKey','metaKey',""],classes:{lasso:"ui-lasso",selected:"ui-selected",container:"ui-container",selecting:"ui-selecting",selectable:"ui-selectable",deselecting:"ui-deselecting"}};this.config=_extend(c,a);this.origin={x:0,y:0};this.mouse={x:0,y:0};var o=this.config;this.autoscroll=isObject(o.autoScroll);this.lasso=false;if(o.lasso&&isObject(o.lasso)){this.lasso=document.createElement('div');this.lasso.className=o.classes.lasso;_css(this.lasso,_extend({position:"absolute",boxSizing:"border-box",opacity:0,},o.lasso))}if(this.touch){o.toggle=false}this.events={};["_start","_touchstart","_drag","_end","_keyup","_keydown","_blur","_focus"].forEach(event=>{this.events[event]=this[event].bind(this)});this.events._refresh=_throttle(this.refresh,o.throttle,this);if(this.autoscroll){this.events._scroll=this._onScroll.bind(this)}this.setContainer();this.scroll={x:this.bodyContainer?window.pageXOffset:this.container.scrollLeft,y:this.bodyContainer?window.pageYOffset:this.container.scrollTop};if(isCollection(o.filter)){this.nodes=[].slice.call(o.filter)}else if(typeof o.filter==="string"){this.nodes=[].slice.call(this.container.querySelectorAll(o.filter))}this.nodes.forEach(node=>{q.add(node,o.classes.selectable)});this.update();this.enable();setTimeout(function(){if(o.saveState){b.state("save")}b.emit(b.v[1]<15?"selectable.init":"init")},10)},update:function(){this._loadItems();this.refresh();this.emit(this.v[1]<15?"selectable.update":"update",this.items)},refresh:function(){var a=window.innerWidth;var b=window.innerHeight;var x=this.bodyContainer?window.pageXOffset:this.container.scrollLeft;var y=this.bodyContainer?window.pageYOffset:this.container.scrollTop;this.offsetWidth=this.container.offsetWidth;this.offsetHeight=this.container.offsetHeight;this.clientWidth=this.container.clientWidth;this.clientHeight=this.container.clientHeight;this.scrollWidth=this.container.scrollWidth;this.scrollHeight=this.container.scrollHeight;this.boundingRect=_rect(this.container);if(this.bodyContainer){this.boundingRect.x2=a;this.boundingRect.y2=b}this.scroll={x:x,y:y,max:{x:this.scrollWidth-(this.bodyContainer?a:this.clientWidth),y:this.scrollHeight-(this.bodyContainer?b:this.clientHeight)},size:{x:this.clientWidth,y:this.clientHeight},scrollable:{x:this.scrollWidth>this.offsetWidth,y:this.scrollHeight>this.offsetHeight}};for(var i=0;i<this.nodes.length;i++){this.items[i].rect=_rect(this.nodes[i])}this.emit(this.v[1]<15?"selectable.refresh":"refresh")},bind:function(){var e=this.events;this.unbind();if(this.touch){this.on(this.container,"touchstart",e._touchstart);this.on(document,"touchend",e._end);this.on(document,"touchcancel",e._end);if(this.lasso!==false){this.on(document,"touchmove",e._drag)}}else{this.on(this.container,"mousedown",e._start);this.on(document,"mouseup",e._end);this.on(document,"keydown",e._keydown);this.on(document,"keyup",e._keyup);this.on(this.container,"mouseenter",e._focus);this.on(this.container,"mouseleave",e._blur);if(this.lasso!==false){this.on(document,"mousemove",e._drag)}}if(this.autoscroll){this.on(this.bodyContainer?window:this.container,"scroll",e._scroll)}this.on(window,'resize',e._refresh);this.on(window,'scroll',e._refresh)},unbind:function(){var e=this.events;this.off(this.container,'mousedown',e._start);this.off(document,'mousemove',e._drag);this.off(document,'mouseup',e._end);this.off(document,'keydown',e._keydown);this.off(document,'keyup',e._keyup);this.off(this.container,"mouseenter",e._focus);this.off(this.container,"mouseleave",e._blur);if(this.autoscroll){this.off(this.bodyContainer?window:this.container,"scroll",e._scroll)}this.off(this.container,"touchstart",e._start);this.off(document,"touchend",e._end);this.off(document,"touchcancel",e._end);this.off(document,"touchmove",e._drag);this.off(window,'resize',e._refresh);this.off(window,'scroll',e._refresh)},setContainer:function(a){var o=this.config,old;if(this.container){old=this.container;this.unbind()}a=a||o.appendTo;if(typeof a==='string'){this.container=document.querySelector(a)}else if(a instanceof Element&&a.nodeName){this.container=a}q.add(this.container,o.classes.container);if(old){q.remove(old,o.classes.container)}this.bodyContainer=this.container===document.body;this._loadItems();if(this.autoscroll){var b=_css(this.container);if(b.position==="static"&&!this.bodyContainer){this.container.style.position="relative"}}this.bind()},select:function(a,b,c){var b=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var c=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(isCollection(a)){var d=this.getSelectedItems().length;for(var i=0;i<a.length;i++){if(!!this.config.maxSelectable&&d>=this.config.maxSelectable){break}this.select(a[i],false,false);d++}if(c&&this.config.saveState){this.state("save")}return this.getSelectedItems()}a=this.get(a);if(a){if(this.config.toggle&&this.config.toggle==="drag"&&!b&&a.selected&&!this.cmdDown){return this.deselect(a,false)}var e=a.node,o=this.config.classes;q.remove(e,o.selecting);q.add(e,o.selected);a.selecting=false;a.selected=true;a.startselected=true;if(c&&this.config.saveState){this.state("save")}this.emit(this.v[1]<15?"selectable.select":"selecteditem",a);return a}return false},deselect:function(a,b){if(isCollection(a)){for(var i=0;i<a.length;i++){this.deselect(a[i],false)}if(b&&this.config.saveState){this.state("save")}return this.getSelectedItems()}a=this.get(a);if(a){var c=a.node,o=this.config.classes;a.selecting=false;a.selected=false;a.deselecting=false;a.startselected=false;q.remove(c,o.deselecting);q.remove(c,o.selecting);q.remove(c,o.selected);if(b&&this.config.saveState){this.state("save")}this.emit(this.v[1]<15?"selectable.deselect":"deselecteditem",a);return a}return false},toggle:function(a){var b=this.get(a);if(b){if(!isCollection(b)){b=[b]}for(var i=0;i<b.length;i++){if(b[i].selected){this.deselect(b[i],false)}else{this.select(b[i],false,false)}}if(this.config.saveState){this.state("save")}}},add:function(a){var b=[];if(typeof a==="string"){a=[].slice.call(this.container.querySelectorAll(a))}if(!isCollection(a)){a=[a]}for(var i=0;i<a.length;i++){if(this.nodes.indexOf(a[i])<0&&a[i]instanceof Element){b.push(a[i]);q.add(a[i],this.config.classes.selectable)}}this.nodes=this.nodes.concat(b);this.update();for(var i=0;i<b.length;i++){this.emit("addeditem",this.get(b[i]))}},remove:function(a,b){a=this.get(a);if(a){if(isCollection(a)){for(var i=a.length-1;i>=0;i--){this.remove(a[i],i>0)}}else{var c=a.node,o=this.config.classes,rm=q.remove;rm(c,o.selectable);rm(c,o.deselecting);rm(c,o.selecting);rm(c,o.selected);this.nodes.splice(this.nodes.indexOf(a.node),1);this.emit("removeditem",a)}if(!b){this.update()}return true}return false},selectAll:function(){if(!!this.config.maxSelectable&&this.config.maxSelectable<this.items.length){return this._maxReached()}for(var i=0;i<this.items.length;i++){this.select(this.items[i],true,false)}if(save&&this.config.saveState){this.state("save")}},invert:function(){var a=this.getItems();if(!!this.config.maxSelectable&&this.config.maxSelectable<a.length){return this._maxReached()}for(var i=0;i<this.items.length;i++){var b=this.items[i];if(b.selected){this.deselect(b,false)}else{this.select(b,false,false)}}if(this.config.saveState){this.state("save")}},clear:function(a){var a=arguments.length>0&&arguments[0]!==undefined?false:true;for(var i=this.items.length-1;i>=0;i--){this.deselect(this.items[i],false)}if(a&&this.config.saveState){this.state("save")}},get:function(a){var b=false;if(typeof a==="string"){a=[].slice.call(this.container.querySelectorAll(a))}if(isCollection(a)){b=[];for(var i=0;i<a.length;i++){var c=this.get(a[i]);if(c){b.push(c)}}}else{if(!isNaN(a)){if(this.items.indexOf(this.items[a])>=0){b=this.items[a]}}else if(a instanceof Element){b=this.items[this.nodes.indexOf(a)]}else if(isObject(a)&&this.items.indexOf(a)>=0){b=a}}return b},getItems:function(){return this.items},getNodes:function(){return this.nodes},getSelectedItems:function(b){return this.getItems().filter(function(a){return b?!a.selected:a.selected})},getSelectedNodes:function(){return this.getSelectedItems().map(function(a){return a.node})},state:function(a){var b=false;var c=false;switch(a){case"save":this.states=this.states||[];this.states.push(this.getSelectedNodes());if(isNumber(this.config.saveState)){if(this.states.length>this.config.saveState){this.states.shift()}}this.currentState=this.states.length-1;c=true;break;case"undo":if(this.currentState>0){this.currentState--;b=true;c=true}break;case"redo":if(this.currentState<this.states.length-1){this.currentState++;b=true;c=true}break;case"clear":this.states=[];this.currentState=false;break}if(b){this.clear(false);this.select(this.states[this.currentState],false,false)}if(c){this.emit((this.v[1]<15?"selectable.state.":"state.")+a,this.states[this.currentState],this.states)}},enable:function(){if(!this.enabled){var a=this.config.keys;this.enabled=true;this.canShift=a.indexOf("shiftKey")>=0;this.canCtrl=a.indexOf("ctrlKey")>=0;this.canMeta=a.indexOf("metaKey")>=0;this.bind();q.add(this.container,this.config.classes.container);this.emit(this.v[1]<15?"selectable.enable":"enabled")}return this.enabled},disable:function(){if(this.enabled){var a=this.config.keys;this.enabled=false;this.unbind();q.remove(this.container,this.config.classes.container);this.emit(this.v[1]<15?"selectable.disable":"disabled")}return this.enabled},destroy:function(){this.disable();this.listeners=false;this.clear();this.state("clear");this.remove(this.items)},on:function(a,b,c){if(typeof a==="string"){this.listeners=this.listeners||{};this.listeners[a]=this.listeners[a]||[];this.listeners[a].push(b)}else{arguments[0].addEventListener(arguments[1],arguments[2],false)}},off:function(a,b){if(typeof a==="string"){this.listeners=this.listeners||{};if(a in this.listeners===false)return;this.listeners[a].splice(this.listeners[a].indexOf(b),1)}else{arguments[0].removeEventListener(arguments[1],arguments[2])}},emit:function(a){this.listeners=this.listeners||{};if(a in this.listeners===false)return;for(var i=0;i<this.listeners[a].length;i++){this.listeners[a][i].apply(this,Array.prototype.slice.call(arguments,1))}},_maxReached:function(){return this.emit("maxitems")},_touchstart:function(e){this.off(this.container,"mousedown",this.events.start);this._start(e)},_start:function(e){var b=this,evt=this._getEvent(e),o=this.config,originalEl,cmd=u(e)&&(this.canCtrl||this.canMeta),shift=(this.canShift&&z(e)),count=this.getSelectedItems().length,max=o.maxSelectable;if(!!max&&count>=max&&(cmd||shift||o.toggle)){return this._maxReached()}if(!this.container.contains(e.target)||e.which===3||e.button>0||o.disabled)return;if(this.scroll.scrollable.y&&evt.pageX>this.boundingRect.x1+this.scroll.size.x||this.scroll.scrollable.x&&evt.pageY>this.boundingRect.y1+this.scroll.size.y){return false}if(this.config.ignore){var c=false;var d=this.config.ignore;if(!Array.isArray(d)){d=[d]}for(var i=0;i<d.length;i++){var f=e.target.closest(d[i]);if(f){c=true;break}}if(c){return false}}var g=closest(e.target,function(a){return a===b.container||q.contains(a,o.classes.selectable)});if(!g)return false;if(['INPUT','SELECT','BUTTON','TEXTAREA','OPTION'].indexOf(e.target.tagName)===-1){e.preventDefault()}this.dragging=true;this.origin={x:(evt.pageX)+(this.bodyContainer?0:this.scroll.x),y:(evt.pageY)+(this.bodyContainer?0:this.scroll.y),scroll:{x:this.scroll.x,y:this.scroll.y}};if(this.lasso){this.container.appendChild(this.lasso)}if(g!==this.container){var h=this.get(g);if(typeof h!=='undefined'){h.selecting=true;q.add(g,o.classes.selecting)}}if(o.autoRefresh){this.refresh()}if(shift&&this.startEl){var j=this.items,currentIndex=this.getNodes().indexOf(g),lastIndex=this.getNodes().indexOf(this.startEl),step=currentIndex<lastIndex?1:-1;while((currentIndex+=step)&&currentIndex!==lastIndex){j[currentIndex].selecting=true}}for(var i=0;i<this.items.length;i++){var h=this.items[i],el=h.node,isCurrentNode=el===g;if(h.selected){h.startselected=true;var k=(this.touch||o.toggle||cmd)?isCurrentNode:!isCurrentNode&&!shift;if(k){q.remove(el,o.classes.selected);h.selected=false;q.add(el,o.classes.deselecting);h.deselecting=true}}if(isCurrentNode){originalEl=h}}this.startEl=g;this.emit(this.v[1]<15?"selectable.start":"start",e,originalEl)},_drag:function(e){var o=this.config;if(o.disabled||!this.dragging||(z(e)&&this.canShift))return;let tmp;var a=this._getEvent(e);var b=u(e)&&(this.canCtrl||this.canMeta);this.mouse={x:a.pageX,y:a.pageY};this.current={x1:this.origin.x,y1:this.origin.y,x2:this.mouse.x+(this.bodyContainer?0:this.scroll.x),y2:this.mouse.y+(this.bodyContainer?0:this.scroll.y)};for(var i=0;i<A.length;i++){var c=A[i];if(this.current[B[c]]>this.current[C[c]]){tmp=this.current[C[c]];this.current[C[c]]=this.current[B[c]];this.current[B[c]]=tmp}}this.coords={x1:this.current.x1,x2:this.current.x2-this.current.x1,y1:this.current.y1,y2:this.current.y2-this.current.y1};if(o.lassoSelect==="normal"){for(var i=0;i<this.items.length;i++){this._highlight(this.items[i],u(e)&&(this.canCtrl||this.canMeta),a)}}else if(o.lassoSelect==="sequential"){this._sequentialSelect(a)}if(this.autoscroll){if(!this.bodyContainer){this.coords.x1-=this.boundingRect.x1;this.coords.y1-=this.boundingRect.y1}this._autoScroll()}if(this.lasso){if(!this.bodyContainer&&this.autoscroll&&!this.config.autoScroll.lassoOverflow){this._limitLasso()}_css(this.lasso,{left:this.coords.x1,top:this.coords.y1,width:this.coords.x2,height:this.coords.y2,opacity:1})}this.emit(this.v[1]<15?"selectable.drag":"drag",e,this.coords)},_end:function(e){if(!this.dragging)return;this.dragging=false;var b=this,o=b.config,node=e.target,evt=this._getEvent(e),endEl,selected=[],deselected=[],count=this.getSelectedItems().length,max=o.maxSelectable;if(this.lasso&&this.container.contains(this.lasso)){this.container.removeChild(this.lasso)}if(this.lasso){_css(this.lasso,{opacity:0,left:0,width:0,top:0,height:0});node=document.elementFromPoint(evt.pageX,evt.pageY);if(!node){node=this.container}}endEl=closest(node,function(a){return q.contains(a,o.classes.selectable)});var c=false;for(var i=0;i<this.items.length;i++){var d=this.items[i];if(o.toggle&&d.node===endEl&&d.node===this.startEl){if(d.selecting&&d.startselected){d.deselecting=true;d.selecting=false}}if(d.deselecting){deselected.push(d);this.deselect(d,false)}if(d.selecting){if(!!max&&count+selected.length>=max){d.selecting=false;q.remove(d.node,o.classes.selecting);c=true}else{selected.push(d);this.select(d,false,false)}}}if(o.saveState){this.state("save")}this.emit(this.v[1]<15?"selectable.end":"end",e,selected,deselected);if(c){return this._maxReached()}},_keydown:function(e){this.cmdDown=u(e)&&(this.canCtrl||this.canMeta);var a=false;if(e.key!==undefined){a=e.key}else if(e.keyCode!==undefined){a=e.keyCode}if(a){if(this.cmdDown&&this.focused){switch(a){case 65:case"a":case"A":this.selectAll();break;case 89:case"y":case"Y":this.state("redo");break;case 90:case"z":case"Z":this.state("undo");break}}else{switch(a){case 32:case" ":this.toggle(document.activeElement);break}}}},_keyup:function(e){this.cmdDown=u(e)&&(this.canCtrl||this.canMeta)},_onScroll:function(e){this.scroll.x=this.bodyContainer?window.pageXOffset:this.container.scrollLeft;this.scroll.y=this.bodyContainer?window.pageYOffset:this.container.scrollTop;for(var i=0;i<this.items.length;i++){this.items[i].rect=_rect(this.items[i].node)}},_loadItems:function(){var o=this.config;this.nodes=[].slice.call(this.container.querySelectorAll("."+o.classes.selectable));this.items=[];if(this.nodes.length){for(var i=0;i<this.nodes.length;i++){var a=this.nodes[i];q.add(a,o.classes.selectable);var b={node:a,rect:_rect(a),startselected:false,selected:q.contains(a,o.classes.selected),selecting:q.contains(a,o.classes.selecting),deselecting:q.contains(a,o.classes.deselecting),};var c=this._get2DTransformation(a);if(c){var d=_getOffset(a);var e=c.translate,origin=c.origin,scale=c.scale,w=a.offsetWidth,h=a.offsetHeight,x=d.left,y=d.top;var f=origin.x,ory=origin.y;var g=(w/2),hy=(h/2);var j=x+((g-f)*scale)+f,cy=y+((hy-ory)*scale)+ory;var k=g*scale,shy=hy*scale;var p=[{x:j-k,y:cy-shy},{x:j+k,y:cy-shy},{x:j+k,y:cy+shy},{x:j-k,y:cy+shy}];for(var n=0;n<=3;n++){p[n]=_rotatePoint(p[n].x+e.x,p[n].y+e.y,x+f+e.x,y+ory+e.y,c.angle)}b.transform={rect:p,}}this.items.push(b)}}},_getEvent:function(e){if(this.touch){if(e.type==="touchend"){return e.changedTouches[0]}return e.touches[0]}return e},_autoScroll:function(){var a=this.config.autoScroll;var i=a.increment;var t=a.threshold;var b={x:0,y:0};if(this.bodyContainer){this.mouse.x-=this.scroll.x;this.mouse.y-=this.scroll.y}for(var n=0;n<A.length;n++){var c=A[n];if(this.mouse[c]>=this.boundingRect[C[c]]-t&&this.scroll[c]<this.scroll.max[c]){b[c]=i}else if(this.mouse[c]<=this.boundingRect[B[c]]+t&&this.scroll[c]>0){b[c]=-i}}if(this.bodyContainer){window.scrollBy(b.x,b.y)}else{this.container.scrollTop+=b.y;this.container.scrollLeft+=b.x}},_limitLasso:function(){for(var i=0;i<A.length;i++){var a=A[i];var b=this.boundingRect[B[a]]+this.scroll.size[a];if(this.mouse[a]>=b&&this.scroll[a]>=this.scroll.max[a]){var c=this.origin[a]-this.boundingRect[B[a]]-this.scroll[a];this.coords[B[a]]=this.origin[a]-this.boundingRect[B[a]];this.coords[C[a]]=b-c-this.boundingRect[B[a]]}if(this.mouse[a]<=this.boundingRect[B[a]]&&this.scroll[a]<=0){this.coords[B[a]]=0;this.coords[C[a]]=this.origin[a]-this.boundingRect[B[a]]}}},_sequentialSelect:function(e){var c=this.config.classes,lastEl=document.elementFromPoint(e.pageX,e.pageY-window.pageYOffset),start,end,items;if(lastEl){lastEl=lastEl.closest(`.${c.selectable}`);if(lastEl){if(this.mouse.y>this.origin.y){start=this.nodes.indexOf(this.startEl);end=this.nodes.indexOf(lastEl)}else if(this.mouse.y<this.origin.y){start=this.nodes.indexOf(lastEl);end=this.nodes.indexOf(this.startEl)}for(var i=0;i<this.items.length;i++){var a=this.items[i];if(i>=start&&i<=end){this._highlight(a,u(e)&&(this.canCtrl||this.canMeta))}else{a.selecting=false;a.node.classList.remove(c.selecting)}}}}},_highlight:function(b,c,d){var o=this.config,el=b.node,over=false;var x=this.bodyContainer?0:this.scroll.x;var y=this.bodyContainer?0:this.scroll.y;if(o.lassoSelect==="normal"){if(o.tolerance==="touch"){if(b.transform){var a=[{x:this.origin.x,y:this.origin.y},{x:this.mouse.x+x,y:this.origin.y},{x:this.mouse.x+x,y:this.mouse.y+y},{x:this.origin.x,y:this.mouse.y+y},];over=_rectsIntersecting(a,b.transform.rect)}else{over=!(b.rect.x1+x>this.current.x2||(b.rect.x2+x<this.current.x1||(b.rect.y1+y>this.current.y2||b.rect.y2+y<this.current.y1)))}}else if(o.tolerance==="fit"){over=b.rect.x1+x>this.current.x1&&(b.rect.x2+x<this.current.x2&&(b.rect.y1+y>this.current.y1&&b.rect.y2+y<this.current.y2))}}else{over=true}if(over){if(b.selected&&!o.toggle){q.remove(el,o.classes.selected);b.selected=false}if(b.deselecting&&(!o.toggle||o.toggle&&o.toggle!=="drag")){q.remove(el,o.classes.deselecting);b.deselecting=false}if(!b.selecting){q.add(el,o.classes.selecting);b.selecting=true}}else{if(b.selecting){q.remove(el,o.classes.selecting);b.selecting=false;if(c&&b.startselected){q.add(el,o.classes.selected);b.selected=true}else{if(b.startselected&&!o.toggle){q.add(el,o.classes.deselecting);b.deselecting=true}}}if(el.selected){if(!c){if(!b.startselected){q.remove(el,o.classes.selected);b.selected=false;q.add(el,o.classes.deselecting);b.deselecting=true}}}}},_focus:function(e){this.focused=true;q.add(this.container,"ui-focused")},_blur:function(e){this.focused=false;q.remove(this.container,"ui-focused")},_get2DTransformation:function(b){var r=window.getComputedStyle(b,null),trans=r.getPropertyValue("-webkit-transform")||r.getPropertyValue("-moz-transform")||r.getPropertyValue("-ms-transform")||r.getPropertyValue("-o-transform")||r.getPropertyValue("transform")||!1;if(trans&&"none"!==trans){var e=trans.split("(")[1].split(")")[0].split(", "),a=parseFloat(e[0]),n=parseFloat(e[1]),l=Math.sqrt(a*a+n*n),o=r.transformOrigin.split(" ").map(o=>parseFloat(o));return{angle:Math.round(Math.atan2(n,a)*(180/Math.PI)),scale:l,origin:{x:parseFloat(o[0]),y:parseFloat(o[1])},translate:{x:parseFloat(e[4]),y:parseFloat(e[5])}}}return!1}};function closest(a,b){return a&&a!==document.documentElement&&(b(a)?a:closest(a.parentNode,b))};function isObject(a){return Object.prototype.toString.call(a)==="[object Object]"};function isCollection(a){return Array.isArray(a)||a instanceof HTMLCollection||a instanceof NodeList};function isNumber(n){if("isInteger"in Number){return Number.isInteger(n)}return!isNaN(n)};function _extend(a,b){for(var c in b){if(b.hasOwnProperty(c)){var d=b[c];if(d&&isObject(d)){a[c]=a[c]||{};_extend(a[c],d)}else{a[c]=d}}}return a};function _css(i,t){var e=i.style;if(i){if(void 0===t)return window.getComputedStyle(i);if(isObject(t))for(var n in t)n in e||(n="-webkit-"+n),i.style[n]=t[n]+("string"==typeof t[n]?"":"opacity"===n?"":"px")}}function _rect(e){var w=window,o=e.getBoundingClientRect(),b=document.documentElement||document.body.parentNode||document.body,d=(void 0!==w.pageXOffset)?w.pageXOffset:b.scrollLeft,n=(void 0!==w.pageYOffset)?w.pageYOffset:b.scrollTop;return{x1:o.left+d,x2:o.left+o.width+d,y1:o.top+n,y2:o.top+o.height+n,height:o.height,width:o.width}};function _throttle(a,b,c){var d;return function(){c=c||this;if(!d){a.apply(c,arguments);d=true;return setTimeout(function(){d=false},b)}}};function _getOffset(a){var b=0,left=0;do{b+=a.offsetTop||0;left+=a.offsetLeft||0;a=a.offsetParent}while(a);return{top:b,left:left}};function _rotatePoint(a,b,x,y,c){c=c*Math.PI/180.0;return{x:Math.cos(c)*(a-x)-Math.sin(c)*(b-y)+x,y:Math.sin(c)*(a-x)+Math.cos(c)*(b-y)+y}};function _rectsIntersecting(a,b){var r,o,t,e,n,v,i,d,f=[a,b];for(e=0;e<f.length;e++){var g=f[e];for(n=0;n<g.length;n++){var h=(n+1)%g.length,l=g[n],x=g[h],y=x.y-l.y,c=l.x-x.x;for(r=o=void 0,v=0;v<a.length;v++)t=y*a[v].x+c*a[v].y,(void 0===r||t<r)&&(r=t),(void 0===o||o<t)&&(o=t);for(i=d=void 0,v=0;v<b.length;v++)t=y*b[v].x+c*b[v].y,(void 0===i||t<i)&&(i=t),(void 0===d||d<t)&&(d=t);if(o<i||d<r)return!1}}return!0};return D});